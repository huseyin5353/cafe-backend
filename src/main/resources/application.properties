
spring.application.name=restaurantbackend

# H2 Database (yedek için yorum satırında)
#spring.datasource.url=jdbc:h2:file:./data/restaurantbackend;DB_CLOSE_ON_EXIT=FALSE;AUTO_RECONNECT=TRUE
#spring.datasource.username=sa
#spring.datasource.password=
#spring.datasource.driver-class-name=org.h2.Driver

# PostgreSQL Database (aktif)
spring.datasource.url=jdbc:postgresql://localhost:5432/restaurantbackend_postgres
spring.datasource.username=postgres
spring.datasource.password=123456
spring.datasource.driver-class-name=org.postgresql.Driver


# Veritabanı şeması ayarları - PostgreSQL için optimize edildi
spring.jpa.hibernate.ddl-auto=update
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true
spring.jpa.hibernate.use_sql_comments=true
spring.jpa.hibernate.format_sql=true
spring.jpa.properties.hibernate.hbm2ddl.auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# PostgreSQL özel ayarları
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.jdbc.time_zone=UTC

# JPA Batch Processing - Performance için
spring.jpa.properties.hibernate.jdbc.batch_size=25
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.batch_versioned_data=true
spring.jpa.properties.hibernate.connection.provider_disables_autocommit=true

# PostgreSQL Transaction Ayarları
spring.jpa.properties.hibernate.connection.autocommit=false
spring.datasource.hikari.auto-commit=false

# Hibernate Batch Fetching - N+1 Query Çözümü
spring.jpa.properties.hibernate.default_batch_fetch_size=20

# Logging Optimization - Performance için
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN
logging.level.root=INFO
logging.level.com.restaurantbackend=INFO

# Yavaş sorguları logla (500ms üzeri)
spring.jpa.properties.hibernate.session.events.log.LOG_QUERIES_SLOWER_THAN_MS=500

# UTF-8 Encoding ayarları
spring.http.encoding.charset=UTF-8
spring.http.encoding.enabled=true
spring.http.encoding.force=true
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true

# Jackson JSON ayarları
spring.jackson.encoding=UTF-8
spring.jackson.default-property-inclusion=NON_NULL
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.deserialization.fail-on-unknown-properties=false

# Connection pool ayarları - 3000 kullanıcı için optimize edildi
spring.datasource.hikari.maximum-pool-size=100
spring.datasource.hikari.minimum-idle=20
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.connection-timeout=15000
spring.datasource.hikari.leak-detection-threshold=30000
spring.datasource.hikari.validation-timeout=5000
spring.datasource.hikari.initialization-fail-timeout=1


# H2 Console (PostgreSQL geçişi için kapatıldı)
spring.h2.console.enabled=false
spring.h2.console.path=/h2-console
spring.h2.console.settings.web-allow-others=false

spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# Upload directory
app.upload.dir=uploads/images

server.port=8080

# Tomcat Thread Pool - 3000 kullanıcı için optimize edildi
server.tomcat.threads.max=300
server.tomcat.threads.min-spare=20
server.tomcat.max-connections=10000
server.tomcat.accept-count=200
server.tomcat.keep-alive-timeout=60000
server.tomcat.connection-timeout=20000

# Rate Limiting Configuration
app.rate-limit.requests-per-minute=100
app.rate-limit.requests-per-second=20
app.rate-limit.window-size-ms=60000
app.rate-limit.burst-window-ms=1000

# JWT Configuration
jwt.secret=mySecretKey123456789012345678901234567890123456789012345678901234567890
jwt.expiration=604800000


#spring.application.name=

#spring.datasource.url=jdbc:postgresql://dpg-d3eh1uvfte5s73cikp60-a.frankfurt-postgres.render.com:5432/restaurantbackend_postgres
# postgresql:postgresql://restaurantbackend_postgres_user:IB02lKPyfoofBfDGaIRkXbAZ8z05utWp@dpg-d3eh1uvfte5s73cikp60-a.frankfurt-postgres.render.com/restaurantbackend_postgres
#spring.datasource.username=restaurantbackend_postgres_user
#spring.datasource.password=IB02lKPyfoofBfDGaIRkXbAZ8z05utWp
#spring.datasource.driver-class-name=org.postgresql.Driver


#spring.jpa.hibernate.ddl-auto=create
#spring.jpa.show-sql=true
#spring.jpa.properties.hibernate.format_sql=true


#spring.h2.console.enabled=true

#spring.servlet.multipart.max-file-size=10MB
#spring.servlet.multipart.max-request-size=10MB

#server.port=8080
